#include "TFile.h"
#include "TGraph.h"

#include <algorithm>
#include <array>

template<std::size_t N>
auto MakeGraph(const char* name, const char* title, const double (&x)[N], const double (&y)[N]) -> TGraph* {
    assert(std::is_sorted(x, x + N));
    const auto g{new TGraph(N, x, y)};
    g->SetNameTitle(name, title);
    g->DrawClone();
    return g;
}

auto CreateEnergySpectrum() -> int {
    if (not TFile::Open("primary_cosmic_ray.root", "NEW")) {
        return 1;
    }
    {
        constexpr double x[]{490.7038824759119,
                             615.8058004629536,
                             759.0701774068848,
                             930.0894259227024,
                             1099.499990480629,
                             1299.767737782423,
                             1518.2578114486537,
                             1773.475918057234,
                             2046.9833741264458,
                             2334.600549089767,
                             2662.630186791915,
                             3000.670908381017,
                             3381.62841579315,
                             3810.9513144410607,
                             4269.19056752376,
                             4782.5297669820775,
                             5293.940681769546,
                             5930.498649509944,
                             6525.5515447748385,
                             7266.6457575784525,
                             7948.123863901521,
                             8745.620735016979,
                             9633.57277980443,
                             10600.183804130596,
                             11585.006632068511,
                             12605.688534696023,
                             13758.417123496924,
                             14999.290880599763,
                             16337.018638863225,
                             17809.033970966335,
                             19415.388601480787,
                             20966.68377221919,
                             22794.07358733416,
                             24805.25943595633,
                             26777.007464747676,
                             28957.1872141708,
                             31193.10628167493,
                             33846.677140728854,
                             36443.05117343832,
                             39410.23868608772,
                             42411.02351755091,
                             45780.44989993366,
                             49093.87289255613,
                             52907.57263580658,
                             57147.43350048743,
                             61510.865991791376,
                             66194.44264070653,
                             71234.63742322408,
                             76658.60405171957,
                             82495.56378372821,
                             88343.71078573844,
                             95536.64186653709,
                             102811.01815351016,
                             110099.33670072738,
                             119063.60743246802,
                             129389.19681840239,
                             138561.6542059268,
                             151316.63873656563,
                             165245.7549655386,
                             180457.0849717953,
                             199006.31388924824,
                             218391.1964013352,
                             244400.43975283552,
                             272172.468772354,
                             307581.59163900866,
                             351015.0835514671,
                             406504.31112786283,
                             475394.1403479128,
                             578148.8419261394,
                             717008.1287671548,
                             952255.6126039722,
                             1401524.0886158117};
        constexpr double y[]{5.2452282172085695e-06,
                             5.6498061912413584e-06,
                             5.207965545111787e-06,
                             4.6947060186479604e-06,
                             4.4774693915698596e-06,
                             4.001663828369755e-06,
                             3.5485119071527595e-06,
                             3.0285935475165564e-06,
                             2.609405392868247e-06,
                             2.2679257565094824e-06,
                             1.921057208649794e-06,
                             1.6456787595913958e-06,
                             1.380306091287718e-06,
                             1.140985975636034e-06,
                             9.388924101588991e-07,
                             7.641868889242378e-07,
                             6.338522373343874e-07,
                             5.032936359620517e-07,
                             4.1583239496985753e-07,
                             3.291009106515159e-07,
                             2.7175875895381975e-07,
                             2.1886594812235523e-07,
                             1.7471357570165505e-07,
                             1.3947486660904587e-07,
                             1.1288062802411415e-07,
                             9.183116813521019e-08,
                             7.391691335680343e-08,
                             5.967063382251268e-08,
                             4.7978399818451395e-08,
                             3.847380036972105e-08,
                             3.0801394456489037e-08,
                             2.5216846641899577e-08,
                             2.0206109342515528e-08,
                             1.6145326542315516e-08,
                             1.3145835475667562e-08,
                             1.066066200355582e-08,
                             8.721177030186938e-09,
                             6.986938944359399e-09,
                             5.709575712135204e-09,
                             4.617719622016427e-09,
                             3.784316698814075e-09,
                             3.0612636155545596e-09,
                             2.5257097896469896e-09,
                             2.054262482850871e-09,
                             1.6597422333363001e-09,
                             1.3542344844458452e-09,
                             1.1108251651704766e-09,
                             9.018994284726423e-10,
                             7.370285196012103e-10,
                             5.983205741099708e-10,
                             4.944777593953665e-10,
                             3.9951558699172804e-10,
                             3.261428035107056e-10,
                             2.6769915395656193e-10,
                             2.164912171771086e-10,
                             1.710998441808013e-10,
                             1.4081504549528017e-10,
                             1.1013601488048966e-10,
                             8.630916262617975e-11,
                             6.715516473753416e-11,
                             5.0985802403880863e-11,
                             3.92192913419651e-11,
                             2.870249285275802e-11,
                             2.1306188928338948e-11,
                             1.515182992350807e-11,
                             1.0368072434691007e-11,
                             6.968279426270152e-12,
                             4.526140780727097e-12,
                             2.6862135232439466e-12,
                             1.5220349094233146e-12,
                             6.967180915527777e-13,
                             2.402602589304194e-13};
        MakeGraph("AMS_Proton", "Proton energy spectrum (AMS)", x, y)->Write();
    }
    {
        constexpr double x[]{1.03259929037087E+03,
                             1.03435005500478E+03,
                             1.03582747862723E+03,
                             1.03786235532675E+03,
                             1.03786235532675E+03,
                             1.03943869633703E+03,
                             1.04051412327631E+03,
                             1.04329109776194E+03,
                             1.04386200426554E+03,
                             1.04679660499160E+03,
                             1.04924318530144E+03,
                             1.05050049900145E+03,
                             1.05308515012426E+03,
                             1.05374619540350E+03,
                             1.05714329535675E+03,
                             1.05997439841234E+03,
                             1.06142894743604E+03,
                             1.06441826299920E+03,
                             1.06518263441756E+03,
                             1.06857576339904E+03,
                             1.07155209607680E+03,
                             1.07406123533415E+03,
                             1.07692941287648E+03,
                             1.07928629043799E+03,
                             1.08200565532121E+03,
                             1.08574624965045E+03,
                             1.08929372809999E+03,
                             1.09161188752917E+03,
                             1.09466340730459E+03,
                             1.09779662748898E+03,
                             1.10210475606236E+03,
                             1.10431609060078E+03,
                             1.10885634039816E+03,
                             1.11355750530541E+03,
                             1.11966799028474E+03,
                             1.12346299900048E+03,
                             1.12867784075940E+03,
                             1.13407462498086E+03,
                             1.14108494876497E+03,
                             1.14543639712566E+03,
                             1.15141288254535E+03,
                             1.15917239079764E+03,
                             1.16892322457860E+03,
                             1.18093177827921E+03,
                             1.18811220162600E+03,
                             1.19742573947479E+03,
                             1.21111937189576E+03,
                             1.22138660346297E+03,
                             1.23207462570573E+03,
                             1.24319764899101E+03,
                             1.25477017748366E+03,
                             1.26680700696715E+03,
                             1.28188533979855E+03,
                             1.29768061634791E+03,
                             1.31422003905656E+03,
                             1.33153139521413E+03,
                             1.34964305244366E+03,
                             1.36858395498568E+03,
                             1.39176916070801E+03,
                             1.41617112091191E+03,
                             1.43809257711710E+03,
                             1.46488481826691E+03,
                             1.49717206098044E+03,
                             1.53131255654565E+03,
                             1.56738592635523E+03,
                             1.61038049397550E+03,
                             1.66128756478523E+03,
                             1.71565787973167E+03,
                             1.77366526016145E+03,
                             1.83548931870648E+03,
                             1.90812600959395E+03,
                             1.99319150036252E+03,
                             2.08467401025478E+03,
                             2.18293753743205E+03,
                             2.28836397581696E+03,
                             2.40135474297354E+03,
                             2.52233250731051E+03,
                             2.65174300626035E+03,
                             2.79005694938790E+03,
                             2.93777200283851E+03,
                             3.09541485397998E+03,
                             3.26354335740528E+03,
                             3.47373673369115E+03,
                             3.66666026009564E+03,
                             3.87206750179032E+03,
                             4.09067125029807E+03,
                             4.32322803992460E+03,
                             4.57054092862493E+03,
                             4.81093440525120E+03,
                             5.11289750781156E+03,
                             5.40980694646621E+03,
                             5.72521060855556E+03,
                             6.06019109473710E+03,
                             6.41589751886418E+03,
                             6.79354951330501E+03,
                             7.19444146529244E+03,
                             7.61264576976281E+03,
                             8.07152372782794E+03,
                             8.55071827036705E+03,
                             9.05917158791087E+03,
                             9.59862462283515E+03,
                             1.01709242817133E+04,
                             1.07780297763150E+04,
                             1.14220193458605E+04,
                             1.21050973839985E+04,
                             1.28296019952954E+04,
                             1.35980130074363E+04,
                             1.44129604668494E+04,
                             1.52772336470748E+04,
                             1.61937906009202E+04,
                             1.71657682892713E+04,
                             1.81964933213753E+04,
                             1.92894933434812E+04,
                             2.04485091149246E+04,
                             2.16775073130748E+04,
                             2.29806941110494E+04,
                             2.43625295747256E+04,
                             2.58277429283802E+04,
                             2.73813487412462E+04,
                             2.90286640904249E+04,
                             3.07753267589224E+04,
                             3.26273145311214E+04,
                             3.45909656517464E+04,
                             3.66730005183616E+04,
                             3.88805446816592E+04,
                             4.12211532322653E+04,
                             4.37028366575400E+04,
                             4.63340882568696E+04,
                             4.91239132092895E+04,
                             5.20818593929211E+04,
                             5.52180500617077E+04,
                             5.85432184912864E+04,
                             6.20687447125702E+04,
                             6.58066944587636E+04,
                             6.97698604591021E+04,
                             7.39718062206467E+04,
                             7.84269124479683E+04,
                             8.31504262595961E+04,
                             8.77298920746903E+04,
                             9.34683134133371E+04,
                             9.90979986053977E+04,
                             1.05066835932680E+05,
                             1.11395253093273E+05,
                             1.18681965114018E+05,
                             1.25218764944228E+05,
                             1.32761169103400E+05,
                             1.40757933945041E+05,
                             1.49236427528622E+05,
                             1.58225666577882E+05,
                             1.67756415787420E+05,
                             1.79603655794213E+05,
                             1.90422202607196E+05,
                             2.01892448728926E+05,
                             2.14053649831203E+05,
                             2.26947426304194E+05,
                             2.42975076481541E+05,
                             2.57611036708055E+05,
                             2.73128642731823E+05,
                             2.89581001874334E+05,
                             3.07024420548105E+05,
                             3.25518596959274E+05,
                             3.44790534459574E+05,
                             3.65916212957471E+05,
                             3.87957908998236E+05,
                             4.11327348851570E+05,
                             4.36104511887539E+05,
                             4.62374195255922E+05,
                             4.90226304095256E+05,
                             5.19756159223405E+05,
                             5.51064823362703E+05,
                             5.84259447016159E+05,
                             6.21267963491742E+05,
                             6.56767836136455E+05,
                             6.96329753690896E+05,
                             7.38274784208270E+05,
                             7.82746480000435E+05,
                             8.29897040616762E+05,
                             8.79887833730573E+05,
                             9.32889947402466E+05,
                             9.89084775610636E+05,
                             1.04866463905205E+06,
                             1.11183344333917E+06,
                             1.17307537674177E+06,
                             1.24981565058308E+06,
                             1.32510128265975E+06,
                             1.40492192997479E+06,
                             1.48955077002538E+06,
                             1.57927743582618E+06,
                             1.67440900714688E+06,
                             1.77527106145937E+06,
                             1.88220878819125E+06,
                             1.99558817009917E+06,
                             2.11579723580511E+06,
                             2.24324738778214E+06,
                             2.37837481033474E+06,
                             2.52164196239221E+06,
                             2.67353916022416E+06,
                             2.83458625549462E+06,
                             3.00533441439800E+06,
                             3.18636800396545E+06,
                             3.37830659199766E+06,
                             3.58180706746825E+06,
                             3.79756588865507E+06,
                             4.02632146669295E+06,
                             4.26885669270564E+06,
                             4.52600161716566E+06,
                             4.79863629065190E+06,
                             5.08769377572716E+06,
                             5.39416334024344E+06,
                             5.72467199824884E+06,
                             6.06359732336738E+06,
                             6.42885280708401E+06,
                             6.81611034138113E+06,
                             7.22669527311499E+06,
                             7.66201278462635E+06,
                             8.12355270282429E+06,
                             8.61289459795721E+06,
                             9.13171318952028E+06,
                             9.68178407780119E+06,
                             1.02649898206792E+07,
                             1.08833263764752E+07,
                             1.15389099349022E+07,
                             1.22339841594945E+07,
                             1.29709278663033E+07,
                             1.37522631651354E+07,
                             1.45806640912008E+07,
                             1.54589657567072E+07,
                             1.63901740537244E+07,
                             1.73774759415228E+07,
                             1.84242503535957E+07,
                             1.95340797616923E+07,
                             2.07107624364380E+07,
                             2.19369291199242E+07,
                             2.32810384408092E+07,
                             2.46834282609363E+07,
                             2.61702944337494E+07,
                             2.77467255972562E+07,
                             2.94181169159186E+07,
                             3.11901885450174E+07,
                             3.30690052072620E+07,
                             3.50609969486460E+07,
                             3.71729811445805E+07,
                             3.94121858316219E+07,
                             4.17862744446413E+07,
                             4.43033720440990E+07,
                             4.69720931231805E+07,
                             4.98015710899650E+07,
                             5.28014895255221E+07,
                             5.59821153249164E+07,
                             5.93543338345412E+07,
                             6.29296861060338E+07,
                             6.67204083942726E+07,
                             7.07394740346290E+07,
                             7.50006378428005E+07,
                             7.95184831891722E+07,
                             8.43084719088194E+07,
                             8.93869972179587E+07,
                             9.47714398179494E+07,
                             1.00480227378858E+08,
                             1.06532897606156E+08,
                             1.12950165106398E+08,
                             1.19753992280709E+08,
                             1.26967664488721E+08,
                             1.34615869740185E+08,
                             1.42724783187004E+08,
                             1.51322156704850E+08,
                             1.60437413870942E+08,
                             1.70101750663045E+08,
                             1.80348242224315E+08,
                             1.91211956059386E+08,
                             2.02730072049096E+08,
                             2.14942009694591E+08,
                             2.27889563026288E+08,
                             2.41617043639403E+08,
                             2.56171432345578E+08,
                             2.71602539959600E+08,
                             2.87963177771513E+08,
                             3.05309338287518E+08,
                             3.23700386858246E+08,
                             3.43199264850225E+08,
                             3.63872705055870E+08,
                             3.85791460079219E+08,
                             4.09030544479036E+08,
                             4.33669491497992E+08,
                             4.59792625256556E+08,
                             4.87489349343129E+08,
                             5.16854452788128E+08,
                             5.47988434469142E+08,
                             5.80997847057429E+08,
                             6.15995661682860E+08,
                             6.53101654565347E+08,
                             6.92442816935945E+08,
                             7.34153789650548E+08,
                             7.78377323983601E+08,
                             8.25264770178834E+08,
                             8.74976595429031E+08,
                             9.27682933057573E+08,
                             9.83564164781259E+08};
        constexpr double y[]{6.06000276809982E+02,
                             6.15505146532676E+02,
                             6.17393720602460E+02,
                             6.28775258952936E+02,
                             6.01730314330184E+02,
                             6.23589215087305E+02,
                             6.26639043471875E+02,
                             6.30144703095319E+02,
                             6.40403388726820E+02,
                             6.39133451024333E+02,
                             6.37214968080735E+02,
                             6.45193132854688E+02,
                             6.38711228901247E+02,
                             6.49109376619418E+02,
                             6.39605986457693E+02,
                             6.38591099937715E+02,
                             6.44755101142148E+02,
                             6.37674408302371E+02,
                             6.48668686107713E+02,
                             6.36325669720432E+02,
                             6.37506189335410E+02,
                             6.34643757399388E+02,
                             6.33205506737065E+02,
                             6.27175932637148E+02,
                             6.27318451202687E+02,
                             6.19257156776062E+02,
                             6.13406859273742E+02,
                             6.15160984813109E+02,
                             6.07497046763635E+02,
                             6.05055321629165E+02,
                             5.93901433583439E+02,
                             5.97653063220437E+02,
                             5.89136867997953E+02,
                             5.83218130802320E+02,
                             5.68464818828705E+02,
                             5.68325264125499E+02,
                             5.57057890126692E+02,
                             5.50679898762018E+02,
                             5.34723589113822E+02,
                             5.31317012610217E+02,
                             5.21522452900392E+02,
                             5.10014748872070E+02,
                             4.94104958345838E+02,
                             4.75907164896934E+02,
                             4.67465422365285E+02,
                             4.54349679214245E+02,
                             4.34934907938530E+02,
                             4.24433943536140E+02,
                             4.10191973333372E+02,
                             3.97929982771147E+02,
                             3.83850830039078E+02,
                             3.72376263101571E+02,
                             3.57027534933130E+02,
                             3.42311455726861E+02,
                             3.28201948748264E+02,
                             3.13189942565104E+02,
                             2.99147290049057E+02,
                             2.85734274896432E+02,
                             2.69864108745485E+02,
                             2.54634534404992E+02,
                             2.42528470242376E+02,
                             2.28571266857347E+02,
                             2.12701300845503E+02,
                             1.97933204831056E+02,
                             1.83799059837670E+02,
                             1.69232881733550E+02,
                             1.53761963966018E+02,
                             1.39388714063481E+02,
                             1.26144174840385E+02,
                             1.14093373235197E+02,
                             1.01796449175729E+02,
                             8.96373758308243E+01,
                             7.87442957627778E+01,
                             6.91422910113783E+01,
                             6.04533907390723E+01,
                             5.28064472707774E+01,
                             4.60396493027475E+01,
                             4.00641410034700E+01,
                             3.47818861645502E+01,
                             3.01675338724770E+01,
                             2.61406194418224E+01,
                             2.25764051933010E+01,
                             1.90365758628041E+01,
                             1.63866659723623E+01,
                             1.41189689247113E+01,
                             1.21708432931548E+01,
                             1.04321704570882E+01,
                             8.93765057540886E+00,
                             7.75501185109697E+00,
                             6.58822660780983E+00,
                             5.62840556108520E+00,
                             4.80614568623307E+00,
                             4.10401064859355E+00,
                             3.50445128037103E+00,
                             2.99248219073285E+00,
                             2.55530722085119E+00,
                             2.17784447910150E+00,
                             1.84220878511250E+00,
                             1.57307850502550E+00,
                             1.33756279851560E+00,
                             1.14053812720050E+00,
                             9.65207131730044E-01,
                             8.21864511383330E-01,
                             6.96509209269602E-01,
                             5.91111514792734E-01,
                             5.02374858545995E-01,
                             4.24945568016918E-01,
                             3.60982771149454E-01,
                             3.05779103358307E-01,
                             2.59385116213590E-01,
                             2.19614531616870E-01,
                             1.86381855009036E-01,
                             1.57506478949668E-01,
                             1.33482723233081E-01,
                             1.13123203061463E-01,
                             9.56879170266945E-02,
                             8.11314136206763E-02,
                             6.87893151049883E-02,
                             5.82145707738254E-02,
                             4.92887405430127E-02,
                             4.18104623676323E-02,
                             3.53329389841308E-02,
                             3.00146258422403E-02,
                             2.54005808558529E-02,
                             2.15568949074824E-02,
                             1.82775569942493E-02,
                             1.54897633285287E-02,
                             1.31333864770267E-02,
                             1.11618248139518E-02,
                             9.47278669946821E-03,
                             8.04313988115562E-03,
                             6.83571738824610E-03,
                             5.81229814689762E-03,
                             4.93276516134300E-03,
                             4.20616269029137E-03,
                             3.57305118143123E-03,
                             3.05106025782100E-03,
                             2.60532755456524E-03,
                             2.25290675075048E-03,
                             1.88182523319738E-03,
                             1.60387163672321E-03,
                             1.36956028922383E-03,
                             1.17058597602510E-03,
                             9.92116893057085E-04,
                             8.62060726128952E-04,
                             7.36469413360136E-04,
                             6.28877797743657E-04,
                             5.38275168167821E-04,
                             4.61161499066058E-04,
                             3.94535255913831E-04,
                             3.31105801739795E-04,
                             2.83135457068575E-04,
                             2.43607536341726E-04,
                             2.09103183464585E-04,
                             1.79231627626755E-04,
                             1.50630022976193E-04,
                             1.29172734480887E-04,
                             1.10981704971542E-04,
                             9.54426623996802E-05,
                             8.23124523547522E-05,
                             7.06537904558561E-05,
                             6.08810774997289E-05,
                             5.22537871983216E-05,
                             4.49800091561040E-05,
                             3.87004486424775E-05,
                             3.33763618375561E-05,
                             2.86489638929264E-05,
                             2.46493448222860E-05,
                             2.12081038057356E-05,
                             1.82645473968319E-05,
                             1.56998231669352E-05,
                             1.34360142673633E-05,
                             1.16221822436750E-05,
                             9.99018492356642E-06,
                             8.59547709787133E-06,
                             7.39897831894858E-06,
                             6.35399672722457E-06,
                             5.44371880605521E-06,
                             4.69703705214675E-06,
                             4.02984743041822E-06,
                             3.45906345604586E-06,
                             2.97474458280411E-06,
                             2.57649088209420E-06,
                             2.19381573180143E-06,
                             1.87686451043061E-06,
                             1.60950464105534E-06,
                             1.37502023102387E-06,
                             1.18473568359902E-06,
                             1.01357116122140E-06,
                             8.66316142753867E-07,
                             7.44667248105827E-07,
                             6.36479492211258E-07,
                             5.43495512657613E-07,
                             4.64974074394000E-07,
                             3.98549934903290E-07,
                             3.41130715701922E-07,
                             2.91432297583332E-07,
                             2.48856637045371E-07,
                             2.12500900947065E-07,
                             1.81456413778837E-07,
                             1.54947249422149E-07,
                             1.32123325997800E-07,
                             1.12448559507923E-07,
                             9.56583725584279E-08,
                             8.16835371286078E-08,
                             6.97503005684657E-08,
                             5.92514869732909E-08,
                             5.04282215765590E-08,
                             4.30611079752851E-08,
                             3.64041434815018E-08,
                             3.10442324748426E-08,
                             2.64588672060917E-08,
                             2.25081778526112E-08,
                             1.91112107431538E-08,
                             1.62269188763701E-08,
                             1.37844434301202E-08,
                             1.17096093303873E-08,
                             9.93298215483097E-09,
                             8.42192942151276E-09,
                             7.15087951998850E-09,
                             6.07165832793292E-09,
                             5.13585473691030E-09,
                             4.35456396066953E-09,
                             3.68863771301329E-09,
                             3.12750450935013E-09,
                             2.64797551986367E-09,
                             2.24197098128381E-09,
                             1.89911522433429E-09,
                             1.60337642754584E-09,
                             1.36010596023553E-09,
                             1.14884709361438E-09,
                             9.71319997484217E-10,
                             8.23545680981563E-10,
                             6.94652874890593E-10,
                             5.87310733030945E-10,
                             4.96086517093336E-10,
                             4.18833684938522E-10,
                             3.53443887117112E-10,
                             2.98545109235423E-10,
                             2.51816118834270E-10,
                             2.12803280761607E-10,
                             1.79409971472342E-10,
                             1.51399851504453E-10,
                             1.27581704535507E-10,
                             1.07714105504081E-10,
                             9.08544375796617E-11,
                             7.65250792878208E-11,
                             6.45471919104454E-11,
                             5.43669534514708E-11,
                             4.57923193885069E-11,
                             3.85700573943474E-11,
                             3.24715202621388E-11,
                             2.73372584685089E-11,
                             2.30365749905475E-11,
                             1.93574888932280E-11,
                             1.62967632221543E-11,
                             1.37199867701783E-11,
                             1.15451803755886E-11,
                             9.70592963131153E-12,
                             8.16354631827632E-12,
                             6.85977656184687E-12,
                             5.76695265295166E-12,
                             4.85051786753123E-12,
                             4.07393326438655E-12,
                             3.42491916976909E-12,
                             2.87657782418582E-12,
                             2.41602781509018E-12,
                             2.02825439001779E-12,
                             1.70191400611525E-12,
                             1.42943171677610E-12,
                             1.19944020411821E-12,
                             1.00645367412153E-12,
                             8.43321274183171E-13,
                             7.07967874324153E-13,
                             5.93215947447275E-13,
                             4.97298777186643E-13,
                             4.17087593820316E-13,
                             3.49483389162002E-13,
                             2.92698501016896E-13,
                             2.45140155882558E-13,
                             2.05018237879803E-13,
                             1.71625236637796E-13,
                             1.43603324640577E-13,
                             1.20156657912427E-13,
                             1.00490701680608E-13,
                             8.39640354259135E-14,
                             7.01885118803812E-14,
                             5.85622208538516E-14,
                             4.89542351471294E-14,
                             4.08645837988379E-14,
                             3.40795048692315E-14,
                             2.83941491133160E-14,
                             2.37132443348558E-14,
                             1.97292527886251E-14,
                             1.64301267080562E-14,
                             1.36697500601346E-14,
                             1.13731360705164E-14,
                             9.44895923432533E-15};
        MakeGraph("Fit_Proton", "Proton energy spectrum (3 component model fit)", x, y)->Write();
    }

    return 0;
}
